# OOD.txt - Open-Opaque-Diff Scan Routine

# Initial state: Assuming motor is at 0 degrees and filter is Opaque (Position 1)
# If not, these commands might be needed at the start:
# motor move 0
# filter position 1 # Opaque
# WAIT 2000 # Wait for initial positioning

# Angle 0
LOG Starting Angle 0 sequence
filter position 1 # Opaque
WAIT 2000
SPECTROMETER SAVE_SNAPSHOT Opaque_0.csv
LOG Saved Opaque_0.csv
filter position 2 # Open
WAIT 2000
SPECTROMETER SAVE_SNAPSHOT Open_0.csv
LOG Saved Open_0.csv
filter position 5 # Diff
WAIT 2000
SPECTROMETER SAVE_SNAPSHOT Diff_0.csv
LOG Saved Diff_0.csv
LOG Completed Angle 0 sequence for Opaque, Open, and Diff filters.

# Angle 45
LOG Starting Angle 45 sequence
motor move 45
WAIT 2000
filter position 1 # Opaque
WAIT 2000
SPECTROMETER SAVE_SNAPSHOT Opaque_45.csv
LOG Saved Opaque_45.csv
filter position 2 # Open
WAIT 2000
SPECTROMETER SAVE_SNAPSHOT Open_45.csv
LOG Saved Open_45.csv
filter position 5 # Diff
WAIT 2000
SPECTROMETER SAVE_SNAPSHOT Diff_45.csv
LOG Saved Diff_45.csv
LOG Completed Angle 45 sequence for Opaque, Open, and Diff filters.

# Angle 90
LOG Starting Angle 90 sequence
motor move 90
WAIT 2000
filter position 1 # Opaque
WAIT 2000
SPECTROMETER SAVE_SNAPSHOT Opaque_90.csv
LOG Saved Opaque_90.csv
filter position 2 # Open
WAIT 2000
SPECTROMETER SAVE_SNAPSHOT Open_90.csv
LOG Saved Open_90.csv
filter position 5 # Diff
WAIT 2000
SPECTROMETER SAVE_SNAPSHOT Diff_90.csv
LOG Saved Diff_90.csv
LOG Completed Angle 90 sequence for Opaque, Open, and Diff filters.

# Angle 135
LOG Starting Angle 135 sequence
motor move 135
WAIT 2000
filter position 1 # Opaque
WAIT 2000
SPECTROMETER SAVE_SNAPSHOT Opaque_135.csv
LOG Saved Opaque_135.csv
filter position 2 # Open
WAIT 2000
SPECTROMETER SAVE_SNAPSHOT Open_135.csv
LOG Saved Open_135.csv
filter position 5 # Diff
WAIT 2000
SPECTROMETER SAVE_SNAPSHOT Diff_135.csv
LOG Saved Diff_135.csv
LOG Completed Angle 135 sequence for Opaque, Open, and Diff filters.

# End of routine - Optionally return to a known state
LOG Routine OOD.txt finished. Returning to initial position.
motor move 0
WAIT 2000
filter position 1 # Opaque
LOG System returned to Opaque at 0 degrees.
